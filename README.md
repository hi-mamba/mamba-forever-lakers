# mamba-forever-lakers

ã€€æ¹–äººæ€»å† å†›ğŸ†ğŸ†ğŸ†ğŸ†ğŸ†ğŸ†ğŸ†ğŸ†ğŸ†ğŸ†ğŸ†ğŸ†ğŸ†ğŸ†ğŸ†ğŸ†ğŸ†ğŸ†ğŸ†ğŸ†ğŸ†ğŸ†ğŸ†ğŸ†

## å®ç°åŠŸèƒ½åˆ—è¡¨

##### [Redis å»¶è¿Ÿä»»åŠ¡é˜Ÿåˆ—](https://www.jianshu.com/p/63d5c42299f9)

#####  å¤šä¸ªè¯·æ±‚åˆå¹¶ 
<https://juejin.im/post/5de35474e51d4532ed6daaeb>

#### å»¶æ—¶é˜Ÿåˆ—

##### å»¶æ—¶é˜Ÿåˆ—ä½¿ç”¨åœºæ™¯
é‚£ä¹ˆä»€ä¹ˆæ—¶å€™éœ€è¦ç”¨å»¶æ—¶é˜Ÿåˆ—å‘¢ï¼Ÿå¸¸è§çš„å»¶æ—¶ä»»åŠ¡åœºæ™¯ ä¸¾æ —å­ï¼š

- è®¢å•åœ¨30åˆ†é’Ÿä¹‹å†…æœªæ”¯ä»˜åˆ™è‡ªåŠ¨å–æ¶ˆã€‚
- é‡è¯•æœºåˆ¶å®ç°,æŠŠè°ƒç”¨å¤±è´¥çš„æ¥å£æ”¾å…¥ä¸€ä¸ªå›ºå®šå»¶æ—¶çš„é˜Ÿåˆ—,åˆ°æœŸåå†é‡è¯•ã€‚
- æ–°åˆ›å»ºçš„åº—é“ºï¼Œå¦‚æœåœ¨åå¤©å†…éƒ½æ²¡æœ‰ä¸Šä¼ è¿‡å•†å“ï¼Œåˆ™è‡ªåŠ¨å‘é€æ¶ˆæ¯æé†’ã€‚
- ç”¨æˆ·å‘èµ·é€€æ¬¾ï¼Œå¦‚æœä¸‰å¤©å†…æ²¡æœ‰å¾—åˆ°å¤„ç†åˆ™é€šçŸ¥ç›¸å…³è¿è¥äººå‘˜ã€‚
- é¢„å®šä¼šè®®åï¼Œéœ€è¦åœ¨é¢„å®šçš„æ—¶é—´ç‚¹å‰ååˆ†é’Ÿé€šçŸ¥å„ä¸ªä¸ä¼šäººå‘˜å‚åŠ ä¼šè®®ã€‚
- å…³é—­ç©ºé—²è¿æ¥ï¼ŒæœåŠ¡å™¨ä¸­ï¼Œæœ‰å¾ˆå¤šå®¢æˆ·ç«¯çš„è¿æ¥ï¼Œç©ºé—²ä¸€æ®µæ—¶é—´ä¹‹åéœ€è¦å…³é—­ä¹‹ã€‚
- æ¸…ç†è¿‡æœŸæ•°æ®ä¸šåŠ¡ã€‚æ¯”å¦‚ç¼“å­˜ä¸­çš„å¯¹è±¡ï¼Œè¶…è¿‡äº†ç©ºé—²æ—¶é—´ï¼Œéœ€è¦ä»ç¼“å­˜ä¸­ç§»å‡ºã€‚
- å¤šè€ƒç”Ÿè€ƒè¯•,åˆ°æœŸå…¨éƒ¨è€ƒç”Ÿå¿…é¡»äº¤å·,è¦æ±‚æ—¶é—´éå¸¸å‡†ç¡®çš„åœºæ™¯ã€‚

ä¸‰ã€è§£å†³åŠæ³•å¤šå¦‚é¸¡æ¯›

- å®šæœŸè½®è¯¢ï¼ˆæ•°æ®åº“ç­‰ï¼‰
- JDK DelayQueue
- JDK Timer
- ScheduledExecutorService å‘¨æœŸæ€§çº¿ç¨‹æ± 
- æ—¶é—´è½®(kafka)
- æ—¶é—´è½®(Nettyçš„HashedWheelTimer)
- Redisæœ‰åºé›†åˆï¼ˆzsetï¼‰
- zookeeperä¹‹curator
- RabbitMQ
- Quartz,xxljobç­‰å®šæ—¶ä»»åŠ¡æ¡†æ¶
- Koala(è€ƒæ‹‰)
- JCronTab(ä»¿crontabçš„javaè°ƒåº¦å™¨)
- SchedulerXï¼ˆé˜¿é‡Œï¼‰
- æœ‰èµå»¶è¿Ÿé˜Ÿåˆ—
- .....(é¸¡æ¯›)

<https://juejin.im/post/5d822b7a6fb9a06b3260a9e6>


## é¡¹ç›®æ‰“åŒ…

å¯åŠ¨é¡¹ç›®ï¼Œä¸”æŒ‡å®šç¯å¢ƒ
> gradle clean source:jar package -P prod


## æ³¨æ„äº‹é¡¹

å¦‚æœé¡¹ç›®å¯åŠ¨è¯»å– redis çš„é…ç½®è€æ˜¯ localhost:6379 ï¼Œä½†æ˜¯æˆ‘ä»¬ç¡®å®æ˜¯é…ç½®äº†é›†ç¾¤ã€‚
é‚£ä¹ˆåªèƒ½è¯´æ˜æ˜¯IDEA å·¥ç¨‹æœ‰é—®é¢˜!!!

- è§£å†³åŠæ³•
>  é‡æ–°å¯¼å…¥é¡¹ç›®ï¼Œæˆ–è€…æäº¤ä»£ç ä¹‹åï¼Œé‡æ–°clone é¡¹ç›®ã€‚ä¹‹å‰å°è¯•è¿‡ gradle build ä¸èµ·ä½œç”¨.

> å¦‚æœè¿˜æ˜¯æœ‰é—®é¢˜ï¼Œåˆ é™¤é¡¹ç›®çš„ .gradle å’Œ .idea æ–‡ä»¶å¤¹ï¼Œé‡æ–°å¯åŠ¨idea ä¹‹åé€‰æ‹©æ¬¡é¡¹ç›®ã€‚

#### å¦‚æœè¿™ä¸ªé¡¹ç›®å‡ºç°é—®é¢˜äº†ã€‚
æ‰§è¡Œ
> gradle clean build -x test

ä¸è¦é—®æˆ‘ä¸ºä»€ä¹ˆ... å°±æ˜¯é¡¹ç›®éœ€è¦é‡æ–°æ„å»ºï¼Œæ‰§è¡Œè¿™ä¸ªå¦‚æœå¯åŠ¨é¡¹ç›®å‡ºç°é—®é¢˜ï¼Œé‚£ä¹ˆä½ éœ€ rebuild project


## é‡åˆ°å¼‚å¸¸

#### SLF4J: Class path contains multiple SLF4J bindings.
JAR å†²çª,å› ä¸ºæˆ‘é¡¹ç›®æ·»åŠ zookeeperï¼Œéœ€è¦ç§»é™¤å†²çªJAR
<https://stackoverflow.com/questions/18952479/how-to-exclude-multiple-slf4j-bindings-to-log4j>

#### Failed to load class "org.slf4j.impl.StaticLoggerBinder

#### Gradle build fails on Lombok annotated classes
IDEA 2019.2 GRADLE 5.X LOMBOK 1.18.8  JDK12
<https://stackoverflow.com/questions/35236104/gradle-build-fails-on-lombok-annotated-classes>

```groovy
dependencies{
compileOnly 'org.projectlombok:lombok:1.18.8'
annotationProcessor 'org.projectlombok:lombok:1.18.8'

}
```
å¦‚æœé¡¹ç›®è¿™åœ¨æµ‹è¯•ç±»é‡Œé¢è¿˜æ˜¯æœ‰é—®é¢˜,é‚£ä¹ˆä½ éœ€è¦æ·»åŠ æ’ä»¶
```groovy
 classpath "io.freefair.gradle:lombok-plugin:4.1.0"
 apply plugin: "io.freefair.lombok"
```
å‚è€ƒ     
 [io.freefair.lombok](https://plugins.gradle.org/plugin/io.freefair.lombok)  
 [Applying Lombok plugin to Gradle causes â€œCould not find any public constructorâ€ error](https://stackoverflow.com/questions/56327071/applying-lombok-plugin-to-gradle-causes-could-not-find-any-public-constructor)

#### : [AdminClient clientId=adminclient-1] Connection to node -1 could not be established. Broker may not be available.

#### [springå¤šæ¨¡å—ä¾èµ–æ—¶ï¼Œè¢«ä¾èµ–æ¨¡å—çš„é…ç½®æ–‡ä»¶ä¸ç”Ÿæ•ˆçš„é—®é¢˜è§£å†³](https://blog.csdn.net/u014520745/article/details/82706040)

- æ–¹æ³•ä¸€ï¼š
æŠŠlogæ¨¡å—ä¸­çš„application.ymlæ–‡ä»¶åæ”¹æˆapplication-log.yml

ç„¶ååœ¨webæ¨¡å—ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ï¼Œå…¶å®å°±æ˜¯å’Œæœ¬èº«æ¨¡å—å¼•ç”¨å¤šä¸ªé…ç½®æ–‡ä»¶ä¸€æ ·ï¼Œå¼•ç”¨å³å¯ï¼š
```yaml
spring:
 profiles:
    active: log,kobe
```

- æ–¹æ³•äºŒï¼ˆæ¨èæ–¹æ³•ï¼Œæ¨¡å—ä¹‹é—´å¹¶ä¸ç”¨å†™ä¾èµ–é…ç½®ï¼‰ï¼š   

ç›´æ¥åœ¨logæ¨¡å—çš„resourceç›®å½•ï¼Œæ·»åŠ ä¸€ä¸ªconfigæ–‡ä»¶å¤¹ï¼Œ
åœ¨é‡Œé¢åˆ›å»ºapplication.ymlæ–‡ä»¶å³å¯ï¼š

å®˜ç½‘ä¹Ÿæ˜¯è¿™æ ·ä»‹ç»çš„ï¼š 
<https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#boot-features-external-config-application-property-files>

####  [spring boot multi-project dependencies](https://github.com/spring-projects/spring-boot/issues/9242)

> spring boot gradle å¤šæ¨¡å—,åœ¨å¯¼å…¥å…¶ä»–å­æ¨¡å—ç¼–è¯‘çš„æ—¶å€™æ— æ³•é€šè¿‡ï¼Œæç¤ºä¸å­˜åœ¨æ­¤åŒ…å’Œè¿™ä¸ªç±»
```groovy
:library:compileJava UP-TO-DATE
:library:processResources NO-SOURCE
:library:classes UP-TO-DATE
:library:jar SKIPPED
/Users/yuval/dev/gs-multi-module/complete/application/src/main/java/hello/app/DemoApplication.java:10: error: package hello.service does not exist
import hello.service.Service;
                    ^
/Users/yuval/dev/gs-multi-module/complete/application/src/main/java/hello/app/DemoApplication.java:11: error: package hello.service does not exist
import hello.service.ServiceConfiguration;
                    ^
/Users/yuval/dev/gs-multi-module/complete/application/src/main/java/hello/app/DemoApplication.java:18: error: cannot find symbol
    private final Service service;
                  ^
  symbol:   class Service
  location: class DemoApplication
/Users/yuval/dev/gs-multi-module/complete/application/src/main/java/hello/app/DemoApplication.java:21: error: cannot find symbol
    public DemoApplication(Service service) {
                           ^
  symbol:   class Service
  location: class DemoApplication
/Users/yuval/dev/gs-multi-module/complete/application/src/main/java/hello/app/DemoApplication.java:14: error: cannot find symbol
@Import(ServiceConfiguration.class)
        ^
  symbol: class ServiceConfiguration
5 errors
:application:compileJava FAILED

FAILURE: Build failed with an exception.

* What went wrong:
Execution failed for task ':application:compileJava'.
> Compilation failed; see the compiler error output for details.
``` 

- è§£å†³æ–¹æ³•  
@mrmeisen in your lib project's build.gradle disable bootJar and re-enable the jar tasks via

```groovy
bootJar { enabled = false }
jar {enabled = true}
```
å¯ä»¥åœ¨ subprojects{} é‡Œé¢æ·»åŠ 

#### Failed to configure a DataSource: 'url' attribute is not specified and no embedded datasource could be configured.
```
Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
2019-08-21 16:36:17.368 ERROR 87870 --- [           main] o.s.b.d.LoggingFailureAnalysisReporter   : 

***************************
APPLICATION FAILED TO START
***************************

Description:

Failed to configure a DataSource: 'url' attribute is not specified and no embedded datasource could be configured.

Reason: Failed to determine a suitable driver class


Action:

Consider the following:
	If you want an embedded database (H2, HSQL or Derby), please put it on the classpath.
	If you have database settings to be loaded from a particular profile you may need to activate it (no profiles are currently active).


Process finished with exit code 1
```

æŸ¥é˜…èµ„æ–™ï¼Œç½‘ä¸Šå¤§ä½“æœ‰ä¸‰ç§è§£å†³æ–¹æ¡ˆï¼š

1ã€ä½¿ç”¨exclude= {DataSourceAutoConfiguration.class}æ’é™¤DataSourceçš„è‡ªåŠ¨é…ç½®ï¼›

2ã€æ£€æŸ¥æ˜¯å¦å°†resourcesæ–‡ä»¶å¤¹è®¾ç½®æˆäº†Resources Rootç›®å½•ï¼ˆåå­—æ˜¯å¦æœ‰å†™é”™ï¼‰ï¼›

3ã€åœ¨pom.xmlçš„buildæ ‡ç­¾ä¸­æ·»åŠ resourcesæŒ‡å®šèµ„æºç›®å½•ï¼›

ä¸Šé¢çš„éƒ½è§£å†³ä¸äº†æˆ‘è¿™ä¸ªé¡¹ç›®è¯´çš„è¿™ä¸ªé—®é¢˜

- æœ€åçš„è§£å†³æ–¹æ¡ˆï¼š

[springbooté¡¹ç›®æç¤ºâ€œFailed to determine a suitable driver classâ€](https://www.jiweichengzhu.com/article/e6cbb2d6aa7648f1b3046ba7e8580803)

IDEA Build æ‰§è¡Œä¸‹è¿™ä¸ªå°±è§£å†³äº†
> rebuild project

ç”±äºæˆ‘çš„é¡¹ç›®ä½¿ç”¨gradle åœ¨é¡¹ç›®æ‰§è¡Œ   gradle  clean build -x test  å¯åŠ¨é¡¹ç›®å°±ä¼šæœ‰è¿™æ ·çš„é—®é¢˜

[IDEA ä¸è‡ªåŠ¨å¤åˆ¶èµ„æºæ–‡ä»¶åˆ°ç¼–è¯‘ç›®å½• classes çš„é—®é¢˜](https://blog.csdn.net/wungmc/article/details/53793177)


#### [Spring Cloud Streamå¦‚ä½•æ¶ˆè´¹è‡ªå·±ç”Ÿäº§çš„æ¶ˆæ¯](http://blog.didispace.com/spring-cloud-starter-finchley-7-1/)

> org.springframework.beans.factory.BeanDefinitionStoreException: Invalid bean definition with name 'example-topic' defined in com.didispace.stream.TestTopic: bean definition with this name already exists - Root bean: class [null]; scope=; abstract=false; lazyInit=false; autowireMode=0; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=com.didispace.stream.TestTopic; factoryMethodName=input; initMethodName=null; destroyMethodName=null

#### idea é”™è¯¯ Two modules in a project cannot share the same content root

ç›´æ¥æŠŠé¡¹ç›® .idea å’Œ.gradle åˆ é™¤ï¼Œé‡æ–°å¯¼å…¥é¡¹ç›®ï¼Œç„¶åå¯¼å…¥æ¨¡å—.


#### java.lang.NoClassDefFoundError: org/mockito/MockitoAnnotations$Mock

> æŠŠ  powermock-api-mockito ä¿®æ”¹æˆ 'powermock-api-mockito2 
> https://github.com/powermock/powermock/issues/678
>
>https://github.com/powermock/powermock/issues/684
>
> ä¾èµ–çš„mockitoå·²ç»æ˜¯2.xäº†ï¼Œç„¶åpowermockè™½ç„¶å¯¹åº”æœ‰ä¸€ä¸ªapiï¼Œä½†æ˜¯å¹¶ä¸èƒ½çœŸæ­£çš„æ”¯æŒï¼Œ[springboot2.x å•å…ƒæµ‹è¯• mockito powermock å…¼å®¹æ€§é—®é¢˜è§£å†³]
> https://webcache.googleusercontent.com/search?q=cache:yZStUqwRlgwJ:https://blog.csdn.net/u013076044/article/details/99109487+&cd=2&hl=en&ct=clnk&gl=hk

#### flyway é—®é¢˜
// spring boot åˆ°2.2.0 ç‰ˆæœ¬æ‰æ”¯æŒ flyway6.0 ...
// testCompile group: 'org.flywaydb', name: 'flyway-core', version: '6.0.2'
// ä¸ºä»€ä¹ˆ build.gradle è¿™é‡Œè®¾ç½®æˆ testCompile?
// å› ä¸ºåœ¨spring-boot-autoconfigureé¡¹ç›®ä¸‹æœ‰ä¸€ä¸ªFlywayAutoConfigurationç±»ï¼Œå¦‚æœä¸è®¾ç½®testCompileä¼šå»åŠ è½½ migrationï¼Œå¯¼è‡´é¡¹ç›®å¯åŠ¨ä¸èµ·æ¥
testCompile group: 'org.flywaydb', name: 'flyway-core', version: '5.2.4'


#### [è§£å†³åˆ›å»ºæ•°æ®æº(DataSource) Bean å†²çªé—®é¢˜](http://www.gxitsky.com/2019/06/18/distributed-micro-app-8-sharding-jdbc-imp/)

druid-spring-boot-starter é»˜è®¤å¼€å¯äº†è‡ªåŠ¨é…ç½®ï¼Œåœ¨ application.properties æ–‡ä»¶ä¸­é…ç½®å¤šæ•°æ®æºçš„è¯ï¼Œ
å› æ— æ³•å®šä¹‰æ•°æ®æºåç§°è€Œé‡‡ç”¨é»˜è®¤çš„ï¼Œè‡ªåŠ¨é…ç½®åœ¨åˆ›å»ºå¤šä¸ªæ•°æ®æº Bean æ—¶ä¼šå­˜åœ¨å†²çªã€‚

- è§£å†³æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨çº¯ druid åŒ… æ›¿æ¢ druid-spring-boot-starter åŒ…
```xml
<dependency>
    <groupId>com.alibaba</groupId>
    <artifactId>druid</artifactId>
    <version>1.1.12</version>
</dependency>
```
- è§£å†³æ–¹æ¡ˆäºŒï¼šä½¿ç”¨ druid-spring-boot-starter åŒ…ï¼Œä½†å…³é—­è‡ªåŠ¨é…ç½®
```xml
@SpringBootApplication(exclude = DruidDataSourceAutoConfigure.class)
public class ShardingJdbcApplication {

    public static void main(String[] args) {
        SpringApplication.run(ShardingJdbcApplication.class, args);
    }
}
```
å®é™…æ•°æ®æºæ•°æ®å¥½åï¼ŒSharding-JDBC å°±æ”¯æŒäº†è¯»å†™åˆ†ç¦»ã€‚

## æŠ€èƒ½åŒ…

- âœ… Kafkaç”Ÿäº§æ¶ˆè´¹å®ç°
- åˆ†åº“åˆ†è¡¨çš„å®ç°




## å¦‚ä½•æ‰§è¡Œé¡¹ç›®æµ‹è¯•ç”¨ä¾‹ 

å‰ææ¡ä»¶
1. å¿…é¡»å®‰è£…æœ‰docker,ç„¶åå¯åŠ¨docker.
2. ç„¶ååœ¨é¡¹ç›® mamba-code-academy æ‰§è¡Œ å‘½ä»¤ $ docker-compose up å¯åŠ¨.
3. å°±å¯ä»¥å»æ‰§è¡Œæµ‹è¯•ç”¨ä¾‹äº†

æµ‹è¯•ç”¨ä¾‹ä½¿ç”¨é¡¹ç›®æŠ€èƒ½åŒ…  
1. [Powermock2.0.0 è¯¦ç»† æ€»ç»“](https://www.cnblogs.com/AdaiCoffee/p/10700097.html)
2. [Flyway Programmatic Configuration (Java)](https://flywaydb.org/documentation/api/)
3. [Bitnami MySQL Docker Image](https://github.com/bitnami/bitnami-docker-mysql)




## [Springboot 2.0é€‰æ‹©HikariCPä½œä¸ºé»˜è®¤æ•°æ®åº“è¿æ¥æ± çš„äº”å¤§ç†ç”±](http://blog.didispace.com/Springboot-2-0-HikariCP-default-reason/)
